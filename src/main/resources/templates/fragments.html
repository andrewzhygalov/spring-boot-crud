<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>User Panel</title>
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-giJF6kkoqNQ00vy+HMDP7azOuL0xtbfIcaT9wjKHr8RbDVddVHyTfAAsrekwKmP1" crossorigin="anonymous">
	<link href="/css/style.css" rel="stylesheet"> 
  </head>
  
  <body>  
  
	  <!-- Header -->
	  <div th:fragment="header" class="container-fluid d-flex align-items-center">
		<h1 class="d-flex align-items-center fs-4 text-white mb-0"
			th:text="${authenticated.email + ' with roles: ' + #strings.setJoin(authenticated.roles, ' ')}">
		</h1>
		<a href="../logout" class="ms-auto link-light" hreflang="eng">Logout</a>
	  </div>

	   <!-- Sidebars -->
		<div th:fragment="adminSidebar">
			<a class="nav-link active" aria-current="page" href="#">
					  Admin
			</a>
			<a class="nav-link" th:href="@{/user}">
					  User
			</a>
		</div>
		<div th:fragment="userSidebar">
			<a class="nav-link active" aria-current="page" href="#">
					  User
			</a>
		</div>
		
		<!-- Panels -->
		<div th:fragment="adminPanel(users)">
			<div class="p-2">
				<h2> Admin panel </h2>
			</div>
			<div class="p-2">
				<nav>
				  <div class="nav nav-tabs mb-3" id="nav-tab" role="tablist">
					<a class="nav-link active" id="nav-users-tab" data-bs-toggle="tab" href="#nav-users" role="tab" aria-controls="nav-users" aria-selected="true">Users</a>
					<a class="nav-link" id="nav-adduser-tab" data-bs-toggle="tab" href="#nav-adduser" role="tab" aria-controls="nav-adduser" aria-selected="false">Add user</a>
				  </div>
				</nav>
			</div>
		    <div class="p-2">
				<div class="tab-content" id="nav-tabContent">
				  <div class="tab-pane fade show active" id="nav-users" role="tabpanel" aria-labelledby="nav-users-tab">
					 <table class="table table-striped">
					  <thead>
						  <tr>
							<th scope="col">Id</th>
							<th scope="col">First Name</th>
							<th scope="col">Last Name</th>
							<th scope="col">Age</th>
							<th scope="col">Email</th>
							<th scope="col">Roles</th>
							<th scope="col">Edit</th>
							<th scope="col">Delete</th>
						  </tr>
					  </thead>
					  <tbody>
						 <tr th:each="user : ${users}">
							<td th:text="${user.id}"></td>
							<td th:text="${user.firstName}"></td>
							<td th:text="${user.lastName}"></td>
							<td th:text="${user.age}"></td>
							<td th:text="${user.email}"></td>
							<td th:text="${user.roles}"></td>
							<td>
								<a th:href="@{/editform/{id}(id=${user.id})}" class="btn btn-primary">
									Edit
								</a>
							</td>
							<td>
								<a th:href="@{/deleteform/{id}(id=${user.id})}" class="btn btn-danger">
									Delete
								</a>
							</td>
						</tr>
					  </tbody>
					</table>
				  </div>
				  <div class="tab-pane fade" id="nav-adduser" role="tabpanel" aria-labelledby="nav-profile-tab">
					<form action="#" th:action="@{/adduser}" th:object="${emptyUser}" method="post">
						<div class="form-floating mb-3">
							<input type="text" th:field="*{firstName}" class="form-control" id="floatingFirstName" placeholder="First Name">
							<label for="floatingFirstName">First Name</label>
						</div>
						<div class="form-floating mb-3">
							<input type="text" th:field="*{lastName}" class="form-control"  id="floatingLastName" placeholder="Last name">
							<label for="floatingLastName">Last name</label>
						</div>
						<div class="form-floating mb-3">
							<input type="text" th:field="*{age}" class="form-control" id="floatingAge" placeholder="Age">
							<label for="floatingAge">Age</label>
						</div>
						<div class="form-floating mb-3">
							<input type="email" th:field="*{email}" class="form-control" id="floatingEmail" placeholder="Email">
							<label for="floatingEmail">Email</label>
						</div>
						<div class="form-floating mb-3">
							<input type="password" th:field="*{password}" class="form-control" id="floatingPassword" placeholder="Password">
							<label for="floatingPassword">Password</label>
						</div>
						<div class="mb-3">
						  <select th:field="*{roles}" class="form-select form-select-lg mb-3" aria-label=".form-select-lg example">
							<option selected value="USER">USER</option>
							<option value="ADMIN">ADMIN</option>
							<option value="ADMIN, USER">ADMIN, USER</option>
						  </select>
						</div>
						<button class="btn btn-primary" type="submit">Add user</button>
					</form>
				  </div>
				</div>
			</div>
		</div>
  
		<div th:fragment="userPanel(users)">
			<div class="p-2">
				<h3> About user </h3>
			</div>
			<div class="p-2">
				<table class="table table-striped">
				  <thead>
					  <tr>
						<th scope="col">Id</th>
						<th scope="col">First Name</th>
						<th scope="col">Last Name</th>
						<th scope="col">Age</th>
						<th scope="col">Email</th>
						<th scope="col">Roles</th>
					  </tr>
				  </thead>
				  <tbody>
					 <tr th:each="user : ${users}">
						<td th:text="${user.id}"></td>
						<td th:text="${user.firstName}"></td>
						<td th:text="${user.lastName}"></td>
						<td th:text="${user.age}"></td>
						<td th:text="${user.email}"></td>
						<td th:text="${user.roles}"></td>
					</tr>
				  </tbody>
				</table>
			</div>
		</div>
  </body>
</html>
